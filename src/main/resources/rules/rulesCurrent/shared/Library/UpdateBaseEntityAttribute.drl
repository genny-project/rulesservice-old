package life.genny.rules;

import life.genny.rules.QRules;


rule "Update BaseEntity Attribute"
     when
        rules: QRules(  isState("UPDATE_BASEENTITY_ATTRIBUTE") && 
                        !isState("LOOP_UPDATE_BE_ATTRIBUTE")) 
     then
        
        rules.header();
        rules.setState("LOOP_UPDATE_BE_ATTRIBUTE");
        
        String sourceCode= rules.getAsString("sourceCode");
        String targetCode= rules.getAsString("targetCode");
        String attributeCode= rules.getAsString("attributeCode");
        String value= rules.getAsString("value");

        if(sourceCode == null) {
             rules.println("Update BaseEntity attribute: missing source code");
        }
        else if(targetCode == null) {
            rules.println("Update BaseEntity attribute: missing target code");
        }
        else if(attributeCode == null) {
            rules.println("Update BaseEntity attribute: missing attributeCode code");
        }
        else if(value == null) {
            rules.println("Update BaseEntity attribute: missing value code");
        }
        else {
            rules.updateBaseEntityAttribute(sourceCode, targetCode, attributeCode, value);
        }

	    rules.footer();     		      
end
     	