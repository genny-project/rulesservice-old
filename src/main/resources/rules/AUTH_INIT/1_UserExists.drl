package life.genny.rules;

import life.genny.rules.RulesUtils;
import life.genny.rules.QRules;
import life.genny.qwanda.entity.BaseEntity;

import life.genny.qwanda.message.QEventMessage;

rule "User Exists"
    no-loop true
    when
        m : QEventMessage( QEventMessage.getData().getCode().equals("AUTH_INIT") )
        rules: QRules(( isUserPresent() == true)  && isState("USER_CHECKED")) 
     then
        rules.header();
     	
     	
        BaseEntity user = rules.getUser();
        rules.println("user exists");
        rules.println("User "+user);
        
  		rules.clearState("USER_CHECKED");
  		rules.clearState("NO_USER");
        rules.setState("IS_LOGGED_IN");
		drools.setFocus("payments");
		
	    rules.footer();     		      
end
